CREATE USER "WEBKJW" IDENTIFIED BY "4321"
DEFAULT TABLESPACE USERS
QUOTA UNLIMITED ON USERS;

GRANT CREATE SESSION, RESOURCE TO WEBKJW;

CREATE USER "WEBDUDGH" IDENTIFIED BY "1234"
DEFAULT TABLESPACE USERS
QUOTA UNLIMITED ON USERS;

GRANT CREATE SESSION, RESOURCE TO WEBDUDGH;


CREATE USER JOO
IDENTIFIED BY "1234"
DEFAULT TABLESPACE USERS
QUOTA UNLIMITED ON USERS;

GRANT CONNECT, RESOURCE TO JOO;
GRANT ALTER ANY TABLE TO JOO;

CREATE USER HO
IDENTIFIED BY "1234"
DEFAULT TABLESPACE USERS
QUOTA UNLIMITED ON USERS;

GRANT CONNECT, RESOURCE TO HO;
GRANT ALTER ANY TABLE TO HO;
GRANT ALTER ANY TABLE TO WEBDBA;
GRANT ALTER ANY TABLE TO WEBKJW;
GRANT ALTER ANY TABLE TO WEBDUDGH;


------------------CREATE STOREGROUP
CREATE TABLE STOREGROUP(
SG_CODE NCHAR(8),
SG_NAME NVARCHAR2(20),
SG_CEO NVARCHAR2(5),
SG_PIN NCHAR(6)
)TABLESPACE USERS;

CREATE SYNONYM SG FOR COOKDBA.STOREGROUP;

GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREGROUP TO JOO;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREGROUP TO HO;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREGROUP TO WEBDBA;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREGROUP TO WEBKJW;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREGROUP TO WEBDUDGH;

ALTER TABLE STOREGROUP
ADD CONSTRAINT SG_CODE_PK PRIMARY KEY(SG_CODE)

--------------------CREATE STORES
CREATE TABLE STORES(
ST_CODE NCHAR(10),
ST_NAME NVARCHAR2(20),
ST_ZIPCODE NVARCHAR2(10),
ST_ADDR NVARCHAR2(20),
ST_ADDRDETAIL NVARCHAR2(20),
ST_PHONE NVARCHAR2(11),
ST_SICODE NCHAR(14),
ST_SGCODE NCHAR(8)
)TABLESPACE USERS;

CREATE SYNONYM ST FOR COOKDBA.STORES;


GRANT SELECT, INSERT, UPDATE ON COOKDBA.STORES TO JOO;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STORES TO HO;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STORES TO WEBDBA;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STORES TO WEBKJW;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STORES TO WEBDUDGH;

ALTER TABLE STORES
ADD CONSTRAINT ST_CODE_PK PRIMARY KEY(ST_CODE)
ADD CONSTRAINT SR_OWCODE_FK FOREIGN KEY(SR_OWCODE) 
REFERENCES OWNERS(OW_CODE);

----------------CREATE STOREIMAGES
CREATE TABLE STOREIMAGES(
SI_CODE NCHAR(14),
SI_NAME NCHAR(20),
SI_LOC NVARCHAR2(100)
)TABLESPACE USERS;

CREATE SYNONYM SI FOR COOKDBA.STOREIMAGES;

GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREIMAGES TO JOO;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREIMAGES TO HO;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREIMAGES TO WEBDBA;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREIMAGES TO WEBKJW;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREIMAGES TO WEBDUDGH;

ALTER TABLE STOREIMAGES
ADD CONSTRAINT SI_CODE_PK PRIMARY KEY(SI_CODE)
MODIFY SI_NAME NOT NULL
MODIFY SI_LOC NOT NULL;

-----------------CREATE STORECATEGORIES
CREATE TABLE STORECATEGORIES(
SC_SGCODE    NCHAR(10),
SC_CODE      NCHAR(2),
SC_NAME      NVARCHAR2(20)
)TABLESPACE USERS;

CREATE SYNONYM SC FOR STORECATEGORIES;

GRANT SELECT, INSERT, UPDATE ON COOKDBA.STORECATEGORIES TO JOO;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STORECATEGORIES TO HO;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STORECATEGORIES TO WEBDBA;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STORECATEGORIES TO WEBKJW;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STORECATEGORIES TO WEBDUDGH;

ALTER TABLE STORECATEGORIES 
ADD CONSTRAINT SC_SGCODE_CODE_PK PRIMARY KEY (SC_SGCODE,SC_CODE)
MODIFY SC_NAME NOT NULL
CONSTRAINT SC_SGCODE_FK FOREIGN KEY(SC_SGCODE) 
REFERENCES STORES(ST_CODE);

----------------CREATE STOREEMPLOYEES
CREATE TABLE STOREEMPLOYEES(
SE_STCODE    NCHAR(10),
SE_CODE      NCHAR(3),
SE_SCL       NCHAR(2),
SE_NAME      NVARCHAR2(5),
SE_PIN       NCHAR(6),
SE_SICODE    NCHAR(14)
)TABLESPACE USERS;

CREATE SYNONYM SE FOR STOREEMPLOYEES;

GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREEMPLOYEES TO JOO;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREEMPLOYEES TO HO;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREEMPLOYEES TO WEBDBA;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREEMPLOYEES TO WEBKJW;
GRANT SELECT, INSERT, UPDATE ON COOKDBA.STOREEMPLOYEES TO WEBDUDGH;

ALTER TABLE STOREEMPLOYEES 
ADD CONSTRAINT SE_STCODE_CODE_PK PRIMARY KEY (SE_STCODE,SE_CODE)
MODIFY SE_SCL DEFAULT 'L0'
MODIFY SE_NAME NOT NULL
MODIFY SE_PIN DEFAULT '000000'
MODIFY SE_SICODE DEFAULT '00000000000000'
ADD CONSTRAINT SE_STCODE_FK FOREIGN KEY (SE_STCODE) 
REFERENCES STORES(ST_CODE)
ADD CONSTRAINT SE_STCODE_SCL_FK FOREIGN KEY (SE_STCODE,SE_SCL) 
REFERENCES STORECATEGORIES (SC_SGCODE,SC_CODE);


----------------TABLE CREATE (STOREMENUES)
CREATE TABLE STOREMENUES(
SM_STCODE NCHAR(10),
SM_CODE NCHAR(3),
SM_SCC NCHAR(2),
SM_NAME NVARCHAR2(20),
SM_SCS NCHAR(2),
SM_COLOR NCHAR(6),
SM_SICODE NCHAR(14)
) TABLESPACE USERS;

ALTER TABLE STOREMENUES
ADD CONSTRAINT SM_STCODE_CODE_PK PRIMARY KEY (SM_STCODE,SM_CODE)
MODIFY SM_SCS DEFAULT 'S1'
MODIFY SM_COLOR DEFAULT 'FFFFFF'
MODIFY SM_SICODE DEFAULT '00000000000000';


CREATE SYNONYM SM FOR STOREMENUES;
GRANT SELECT ON SM TO WEBDUDGH;
GRANT SELECT, INSERT, UPDATE ON STOREMENUES TO WEBDUDGH;

ALTER TABLE STOREMENUES
ADD CONSTRAINT SM_STCODE_CODE_PK FOREIGN KEY(SM_STCODE, SM_CODE)
REFERENCES COOKDBA.STORECATEGORIES(SC_SGCODE, SC_CODE)
ADD CONSTRAINT TA_STCODE_CODE_PK PRIMARY KEY(TA_STCODE, TA_CODE)
ADD CONSTRAINT SM_STCODE_SCC_FK FOREIGN KEY (SM_STCODE,SM_SCC) 
REFERENCES COOKDBA.STORECATEGORIES(SC_SGCODE,SC_CODE)
ADD CONSTRAINT SM_STCODE_FK FOREIGN KEY(SM_STCODE)
REFERENCES COOKDBA.STORES(ST_CODE);

---------TABLE CREATE (COSTPRICEMGR)
CREATE TABLE COSTPRICEMGR(
CP_SMSTCODE NCHAR(10),
CP_SMCODE NCHAR(3),
CP_DATE DATE,
CP_COST NUMBER(6,0),
CP_PRICE NUMBER(6,0),
CP_DISCOUNT NCHAR(2),
CP_COMMENT NVARCHAR2(10)
)TABLESPACE USERS;

CREATE SYNONYM CP FOR COSTPRICEMGR;
GRANT SELECT ON CP TO WEBDUDGH;
GRANT SELECT,INSERT,UPDATE ON COSTPRICEMGR TO WEBDUDGH;


ALTER TABLE COSTPRICEMGR
ADD CONSTRAINT CP_SMST_SM_DATE_PK
PRIMARY KEY (CP_SMSTCODE, CP_SMCODE,CP_DATE)
ADD CONSTRAINT CP_SMST_SM_FK FOREIGN KEY (CP_SMSTCODE, CP_SMCODE)
REFERENCES STOREMENUES(SM_STCODE, SM_CODE);



----TABLE CREATE (ACCESSLOG)
CREATE TABLE ACCESSLOG(
AC_SESTCODE NCHAR(10),
AC_SECODE NCHAR(3),
AC_DATE DATE,
AC_IP NVARCHAR2(15),
AC_TYPE NCHAR(1)
)TABLESPACE USERS;

CREATE SYNONYM AC FOR ACCESSLOG;
GRANT SELECT ON AC TO WEBDUDGH;
GRANT SELECT, INSERT, UPDATE ON ACCESSLOG TO WEBDUDGH;

ALTER TABLE ACCESSLOG
ADD CONSTRAINT AC_SEST_SE_FK FOREIGN KEY(AC_SESTCODE, AC_SECODE)
REFERENCES COOKDBA.STOREEMPLOYEES(SE_STCODE, SE_CODE);

----TABLE CREATE (STORETABLES)
CREATE TABLE STORETABLES(
TA_STCODE NCHAR(10),
TA_CODE NUMBER(3),
TA_NAME NVARCHAR2(20),
TA_SEAT NUMBER(2),
TA_GCCODE NCHAR(2),
TA_TOP NVARCHAR2(4),
TA_LEFT NVARCHAR2(4),
TA_WIDTH NVARCHAR2(4),
TA_HEIGHT NVARCHAR2(4)
)TABLESPACE USERS;

CREATE SYNONYM TA FOR STORETABLES;
GRANT SELECT ON TA TO WEBDUDGH;
GRANT SELECT, INSERT, UPDATE ON STORETABLES TO WEBDUDGH;


ALTER TABLE STORETABLES
ADD CONSTRAINT TA_STCODE_CODE_PK PRIMARY KEY(TA_STCODE, TA_CODE);



----TABLE CREATE (GROUPCUSTOMERS)
CREATE TABLE GROUPCUSTOMERS(
GC_SGCODE NCHAR(8),
GC_CODE NCHAR(16),
GC_ID NVARCHAR2(10),
GC_NAME NVARCHAR2(5),
GC_CHECK NCHAR(8)
)TABLESPACE USERS;

CREATE SYNONYM GC FOR GROUPCUSTOMERS;
GRANT SELECT ON GC TO WEBDUDGH;
GRANT SELECT, INSERT, UPDATE ON GROUPCUSTOMERS TO WEBDUDGH;

----------------------CREATE ODERS
CREATE TABLE ODERS(
OS_GCSGCODE    NCHAR(8),
OS_GCCODE      NCHAR(16),
OS_SCCODE       NCHAR(10),
OS_TACODE      NUMBER(3),
OS_STATE       NCHAR(2),
OS_DATE    DATE
)TABLESPACE USERS;

DROP TABLE ODERS;

CREATE SYNONYM OS FOR ODERS;

GRANT SELECT, INSERT, UPDATE ON WEBDBA.ODERS TO JOO;
GRANT SELECT, INSERT, UPDATE ON WEBDBA.ODERS TO HO;
GRANT SELECT, INSERT, UPDATE ON WEBDBA.ODERS TO COOKDBA;
GRANT SELECT, INSERT, UPDATE ON WEBDBA.ODERS TO WEBKJW;
GRANT SELECT, INSERT, UPDATE ON WEBDBA.ODERS TO WEBDUDGH;

ALTER TABLE ODERS ADD CONSTRAINT OS_GCSG_GC_SCCODE_TA_DATE_PK PRIMARY KEY (OS_GCSGCODE,OS_GCCODE,OS_SCCODE,OS_TACODE,OS_DATE);
ALTER TABLE ODERS 
MODIFY OS_STATE DEFAULT 'BO' NOT NULL
MODIFY OS_DATE DEFAULT SYSDATE NOT NULL;
ALTER TABLE ODERS ADD CONSTRAINT OS_GCSGCODE_GCCODE_FK FOREIGN KEY(OS_GCSGCODE, OS_GCCODE) REFERENCES GROUPCUSTOMERS(GC_SGCODE, GC_CODE);
ALTER TABLE ODERS ADD CONSTRAINT OS_SCCODE_TACODE_FK FOREIGN KEY(OS_SCCODE, OS_TACODE) REFERENCES STORETABLES(TA_STCODE, TA_CODE);
ALTER TABLE ODERS ADD CONSTRAINT SC_SGCODE_STATE_FK FOREIGN KEY(OS_SCCODE, OS_STATE) REFERENCES COOKDBA.STORECATEGORIES(SC_SGCODE, SC_CODE);



------------------------CREATE SALES
CREATE TABLE SALES(
SL_SLCODE      NCHAR(10),
SL_OSDATE      DATE,
SL_SLSGCODE    NCHAR(8),
SL_GCCODE      NCHAR(16),
SL_SLPDATE     DATE,
SL_APPROVALNO  NCHAR(9),
SL_DATE        DATE,
SL_AMOUNT      NUMBER(10,0),
SL_METHOD      NCHAR(1),
SL_CARNUM      NVARCHAR2(16)
)TABLESPACE USERS;

ALTER TABLE SALES 
ADD CONSTRAINT SL_SLC_OS_SLS_GC_SLP_PK PRIMARY KEY (SL_SLCODE,SL_OSDATE,SL_SLSGCODE,SL_GCCODE,SL_SLPDATE);

ALTER TABLE SALES 
MODIFY SL_OSDATE DEFAULT SYSDATE NOT NULL
MODIFY SL_SLPDATE DEFAULT SYSDATE NOT NULL
MODIFY SL_APPROVALNO NOT NULL
MODIFY SL_DATE DEFAULT SYSDATE NOT NULL
MODIFY SL_AMOUNT NOT NULL
MODIFY SL_METHOD DEFAULT '0' NOT NULL
MODIFY SL_CARNUM NOT NULL;


GRANT SELECT, INSERT, UPDATE ON WEBDBA.SALES TO JOO;
GRANT SELECT, INSERT, UPDATE ON WEBDBA.SALES TO HO;
GRANT SELECT, INSERT, UPDATE ON WEBDBA.SALES TO COOKDBA;
GRANT SELECT, INSERT, UPDATE ON WEBDBA.SALES TO WEBKJW;
GRANT SELECT, INSERT, UPDATE ON WEBDBA.SALES TO WEBDUDGH;




 CREATE SEQUENCE HOHOHO
            START WITH  1000001
            MAXVALUE    9999999
            INCREMENT BY 1
            NOCACHE;
